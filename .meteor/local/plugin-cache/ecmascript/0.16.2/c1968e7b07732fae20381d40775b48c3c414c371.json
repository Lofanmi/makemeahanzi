{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/a37/code/github/makemeahanzi-tool/lib/hungarian.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"lib/hungarian.js","filename":"/Users/a37/code/github/makemeahanzi-tool/lib/hungarian.js","targets":{},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/a37/code/github/makemeahanzi-tool","root":"/Users/a37/code/github/makemeahanzi-tool","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/a37/code/github/makemeahanzi-tool/lib/hungarian.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"lib/hungarian.js"}},"code":"module.export({\n  Hungarian: () => Hungarian\n});\n\n// This algorithm was pulled from another one of my projects. -skishore\n//   https://github.com/skishore/tesseract/blob/master/coffee/hungarian.coffee\nvar bind = function (fn, me) {\n  return function () {\n    return fn.apply(me, arguments);\n  };\n};\n\nconst Hungarian = function () {\n  function Hungarian(cost_matrix) {\n    var i, j, last_matched, len, ref, ref1, results, row, x, y;\n    this.cost_matrix = cost_matrix;\n    this.get_final_score = bind(this.get_final_score, this);\n    this.update_labels = bind(this.update_labels, this);\n    this.find_root_and_slacks = bind(this.find_root_and_slacks, this);\n    this.augment = bind(this.augment, this);\n    this.match = bind(this.match, this);\n    this.cost = bind(this.cost, this);\n    this.find_greedy_solution = bind(this.find_greedy_solution, this);\n    this.reduce_cost_matrix = bind(this.reduce_cost_matrix, this);\n    this.n = this.cost_matrix.length;\n    ref = this.cost_matrix;\n\n    for (i = 0, len = ref.length; i < len; i++) {\n      row = ref[i];\n\n      if (row.length !== this.n) {\n        throw new Error(\"Malforrmed cost_matrix: \" + this.cost_matrix);\n      }\n    }\n\n    this.range = function () {\n      results = [];\n\n      for (var j = 0, ref1 = this.n; 0 <= ref1 ? j < ref1 : j > ref1; 0 <= ref1 ? j++ : j--) {\n        results.push(j);\n      }\n\n      return results;\n    }.apply(this);\n\n    this.matched = 0;\n\n    this.x_label = function () {\n      var k, len1, ref2, results1;\n      ref2 = this.range;\n      results1 = [];\n\n      for (k = 0, len1 = ref2.length; k < len1; k++) {\n        x = ref2[k];\n        results1.push(0);\n      }\n\n      return results1;\n    }.call(this);\n\n    this.y_label = function () {\n      var k, len1, ref2, results1;\n      ref2 = this.range;\n      results1 = [];\n\n      for (k = 0, len1 = ref2.length; k < len1; k++) {\n        y = ref2[k];\n        results1.push(0);\n      }\n\n      return results1;\n    }.call(this);\n\n    this.x_match = function () {\n      var k, len1, ref2, results1;\n      ref2 = this.range;\n      results1 = [];\n\n      for (k = 0, len1 = ref2.length; k < len1; k++) {\n        x = ref2[k];\n        results1.push(-1);\n      }\n\n      return results1;\n    }.call(this);\n\n    this.y_match = function () {\n      var k, len1, ref2, results1;\n      ref2 = this.range;\n      results1 = [];\n\n      for (k = 0, len1 = ref2.length; k < len1; k++) {\n        y = ref2[k];\n        results1.push(-1);\n      }\n\n      return results1;\n    }.call(this);\n\n    this.reduce_cost_matrix();\n    this.find_greedy_solution();\n\n    while (this.matched < this.n) {\n      last_matched = this.matched;\n      this.augment();\n\n      if (this.matched <= last_matched) {\n        throw new Error(\"Augmentation round did not increase matched!\");\n      }\n    }\n  }\n\n  Hungarian.prototype.reduce_cost_matrix = function () {\n    var i, j, k, l, len, len1, len2, len3, max_cost, ref, ref1, ref2, ref3, row, x, y;\n\n    this.cost_matrix = function () {\n      var i, len, ref, results;\n      ref = this.cost_matrix;\n      results = [];\n\n      for (i = 0, len = ref.length; i < len; i++) {\n        row = ref[i];\n        results.push(row.slice());\n      }\n\n      return results;\n    }.call(this);\n\n    ref = this.range;\n\n    for (i = 0, len = ref.length; i < len; i++) {\n      x = ref[i];\n      max_cost = Math.max.apply(0, function () {\n        var j, len1, ref1, results;\n        ref1 = this.range;\n        results = [];\n\n        for (j = 0, len1 = ref1.length; j < len1; j++) {\n          y = ref1[j];\n          results.push(this.cost_matrix[x][y]);\n        }\n\n        return results;\n      }.call(this));\n      ref1 = this.range;\n\n      for (j = 0, len1 = ref1.length; j < len1; j++) {\n        y = ref1[j];\n        this.cost_matrix[x][y] -= max_cost;\n      }\n\n      this.x_label[x] = 0;\n    }\n\n    ref2 = this.range;\n\n    for (k = 0, len2 = ref2.length; k < len2; k++) {\n      y = ref2[k];\n      max_cost = Math.max.apply(0, function () {\n        var l, len3, ref3, results;\n        ref3 = this.range;\n        results = [];\n\n        for (l = 0, len3 = ref3.length; l < len3; l++) {\n          x = ref3[l];\n          results.push(this.cost_matrix[x][y]);\n        }\n\n        return results;\n      }.call(this));\n      ref3 = this.range;\n\n      for (l = 0, len3 = ref3.length; l < len3; l++) {\n        x = ref3[l];\n        this.cost_matrix[x][y] -= max_cost;\n      }\n\n      this.y_label[y] = 0;\n    }\n  };\n\n  Hungarian.prototype.find_greedy_solution = function () {\n    var i, len, ref, results, x, y;\n    ref = this.range;\n    results = [];\n\n    for (i = 0, len = ref.length; i < len; i++) {\n      x = ref[i];\n      results.push(function () {\n        var j, len1, ref1, results1;\n        ref1 = this.range;\n        results1 = [];\n\n        for (j = 0, len1 = ref1.length; j < len1; j++) {\n          y = ref1[j];\n\n          if (this.x_match[x] === -1 && this.y_match[y] === -1 && this.cost(x, y) === 0) {\n            this.match(x, y);\n            results1.push(this.matched += 1);\n          } else {\n            results1.push(void 0);\n          }\n        }\n\n        return results1;\n      }.call(this));\n    }\n\n    return results;\n  };\n\n  Hungarian.prototype.cost = function (x, y) {\n    return this.cost_matrix[x][y] - this.x_label[x] - this.y_label[y];\n  };\n\n  Hungarian.prototype.match = function (x, y) {\n    this.x_match[x] = y;\n    return this.y_match[y] = x;\n  };\n\n  Hungarian.prototype.augment = function () {\n    var cur_x, cur_y, delta, delta_x, delta_y, i, j, len, len1, new_slack, next_y, ref, ref1, ref2, root, slack, slack_x, x, x_in_tree, y, y_parent;\n\n    x_in_tree = function () {\n      var i, len, ref, results;\n      ref = this.range;\n      results = [];\n\n      for (i = 0, len = ref.length; i < len; i++) {\n        x = ref[i];\n        results.push(false);\n      }\n\n      return results;\n    }.call(this);\n\n    y_parent = function () {\n      var i, len, ref, results;\n      ref = this.range;\n      results = [];\n\n      for (i = 0, len = ref.length; i < len; i++) {\n        y = ref[i];\n        results.push(-1);\n      }\n\n      return results;\n    }.call(this);\n\n    ref = this.find_root_and_slacks(), root = ref[0], slack = ref[1], slack_x = ref[2];\n    x_in_tree[root] = true;\n\n    while (true) {\n      delta = Infinity;\n      ref1 = this.range;\n\n      for (i = 0, len = ref1.length; i < len; i++) {\n        y = ref1[i];\n\n        if (y_parent[y] < 0 && slack[y] < delta) {\n          delta = slack[y];\n          delta_x = slack_x[y];\n          delta_y = y;\n        }\n      }\n\n      this.update_labels(delta, x_in_tree, y_parent, slack);\n      y_parent[delta_y] = delta_x;\n\n      if (this.y_match[delta_y] < 0) {\n        cur_y = delta_y;\n\n        while (cur_y >= 0) {\n          cur_x = y_parent[cur_y];\n          next_y = this.x_match[cur_x];\n          this.match(cur_x, cur_y);\n          cur_y = next_y;\n        }\n\n        this.matched += 1;\n        return;\n      }\n\n      x = this.y_match[delta_y];\n      x_in_tree[x] = true;\n      ref2 = this.range;\n\n      for (j = 0, len1 = ref2.length; j < len1; j++) {\n        y = ref2[j];\n\n        if (y_parent[y] < 0) {\n          new_slack = -this.cost(x, y);\n\n          if (slack[y] > new_slack) {\n            slack[y] = new_slack;\n            slack_x[y] = x;\n          }\n        }\n      }\n    }\n  };\n\n  Hungarian.prototype.find_root_and_slacks = function () {\n    var i, len, ref, x, y;\n    ref = this.range;\n\n    for (i = 0, len = ref.length; i < len; i++) {\n      x = ref[i];\n\n      if (this.x_match[x] < 0) {\n        return [x, function () {\n          var j, len1, ref1, results;\n          ref1 = this.range;\n          results = [];\n\n          for (j = 0, len1 = ref1.length; j < len1; j++) {\n            y = ref1[j];\n            results.push(-this.cost(x, y));\n          }\n\n          return results;\n        }.call(this), function () {\n          var j, len1, ref1, results;\n          ref1 = this.range;\n          results = [];\n\n          for (j = 0, len1 = ref1.length; j < len1; j++) {\n            y = ref1[j];\n            results.push(x);\n          }\n\n          return results;\n        }.call(this)];\n      }\n    }\n  };\n\n  Hungarian.prototype.update_labels = function (delta, x_in_tree, y_parent, slack) {\n    var i, j, len, len1, ref, ref1, results, x, y;\n    ref = this.range;\n\n    for (i = 0, len = ref.length; i < len; i++) {\n      x = ref[i];\n\n      if (x_in_tree[x]) {\n        this.x_label[x] -= delta;\n      }\n    }\n\n    ref1 = this.range;\n    results = [];\n\n    for (j = 0, len1 = ref1.length; j < len1; j++) {\n      y = ref1[j];\n\n      if (y_parent[y] < 0) {\n        results.push(slack[y] -= delta);\n      } else {\n        results.push(this.y_label[y] += delta);\n      }\n    }\n\n    return results;\n  };\n\n  Hungarian.prototype.get_final_score = function (original_matrix) {\n    var x;\n    return Util.sum(function () {\n      var i, len, ref, results;\n      ref = this.range;\n      results = [];\n\n      for (i = 0, len = ref.length; i < len; i++) {\n        x = ref[i];\n        results.push(original_matrix[x][this.x_match[x]]);\n      }\n\n      return results;\n    }.call(this));\n  };\n\n  return Hungarian;\n}();","map":{"version":3,"sources":["lib/hungarian.js"],"names":["module","export","Hungarian","bind","fn","me","apply","arguments","cost_matrix","i","j","last_matched","len","ref","ref1","results","row","x","y","get_final_score","update_labels","find_root_and_slacks","augment","match","cost","find_greedy_solution","reduce_cost_matrix","n","length","Error","range","push","matched","x_label","k","len1","ref2","results1","call","y_label","x_match","y_match","prototype","l","len2","len3","max_cost","ref3","slice","Math","max","cur_x","cur_y","delta","delta_x","delta_y","new_slack","next_y","root","slack","slack_x","x_in_tree","y_parent","Infinity","original_matrix","Util","sum"],"mappings":"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","sourcesContent":["// This algorithm was pulled from another one of my projects. -skishore\n//   https://github.com/skishore/tesseract/blob/master/coffee/hungarian.coffee\n\nvar bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\nconst Hungarian = (function() {\n  function Hungarian(cost_matrix) {\n    var i, j, last_matched, len, ref, ref1, results, row, x, y;\n    this.cost_matrix = cost_matrix;\n    this.get_final_score = bind(this.get_final_score, this);\n    this.update_labels = bind(this.update_labels, this);\n    this.find_root_and_slacks = bind(this.find_root_and_slacks, this);\n    this.augment = bind(this.augment, this);\n    this.match = bind(this.match, this);\n    this.cost = bind(this.cost, this);\n    this.find_greedy_solution = bind(this.find_greedy_solution, this);\n    this.reduce_cost_matrix = bind(this.reduce_cost_matrix, this);\n    this.n = this.cost_matrix.length;\n    ref = this.cost_matrix;\n    for (i = 0, len = ref.length; i < len; i++) {\n      row = ref[i];\n      if (row.length !== this.n) {\n        throw new Error(\"Malforrmed cost_matrix: \" + this.cost_matrix);\n      }\n    }\n    this.range = (function() {\n      results = [];\n      for (var j = 0, ref1 = this.n; 0 <= ref1 ? j < ref1 : j > ref1; 0 <= ref1 ? j++ : j--){ results.push(j); }\n      return results;\n    }).apply(this);\n    this.matched = 0;\n    this.x_label = (function() {\n      var k, len1, ref2, results1;\n      ref2 = this.range;\n      results1 = [];\n      for (k = 0, len1 = ref2.length; k < len1; k++) {\n        x = ref2[k];\n        results1.push(0);\n      }\n      return results1;\n    }).call(this);\n    this.y_label = (function() {\n      var k, len1, ref2, results1;\n      ref2 = this.range;\n      results1 = [];\n      for (k = 0, len1 = ref2.length; k < len1; k++) {\n        y = ref2[k];\n        results1.push(0);\n      }\n      return results1;\n    }).call(this);\n    this.x_match = (function() {\n      var k, len1, ref2, results1;\n      ref2 = this.range;\n      results1 = [];\n      for (k = 0, len1 = ref2.length; k < len1; k++) {\n        x = ref2[k];\n        results1.push(-1);\n      }\n      return results1;\n    }).call(this);\n    this.y_match = (function() {\n      var k, len1, ref2, results1;\n      ref2 = this.range;\n      results1 = [];\n      for (k = 0, len1 = ref2.length; k < len1; k++) {\n        y = ref2[k];\n        results1.push(-1);\n      }\n      return results1;\n    }).call(this);\n    this.reduce_cost_matrix();\n    this.find_greedy_solution();\n    while (this.matched < this.n) {\n      last_matched = this.matched;\n      this.augment();\n      if (this.matched <= last_matched) {\n        throw new Error(\"Augmentation round did not increase matched!\");\n      }\n    }\n  }\n\n  Hungarian.prototype.reduce_cost_matrix = function() {\n    var i, j, k, l, len, len1, len2, len3, max_cost, ref, ref1, ref2, ref3, row, x, y;\n    this.cost_matrix = (function() {\n      var i, len, ref, results;\n      ref = this.cost_matrix;\n      results = [];\n      for (i = 0, len = ref.length; i < len; i++) {\n        row = ref[i];\n        results.push(row.slice());\n      }\n      return results;\n    }).call(this);\n    ref = this.range;\n    for (i = 0, len = ref.length; i < len; i++) {\n      x = ref[i];\n      max_cost = Math.max.apply(0, (function() {\n        var j, len1, ref1, results;\n        ref1 = this.range;\n        results = [];\n        for (j = 0, len1 = ref1.length; j < len1; j++) {\n          y = ref1[j];\n          results.push(this.cost_matrix[x][y]);\n        }\n        return results;\n      }).call(this));\n      ref1 = this.range;\n      for (j = 0, len1 = ref1.length; j < len1; j++) {\n        y = ref1[j];\n        this.cost_matrix[x][y] -= max_cost;\n      }\n      this.x_label[x] = 0;\n    }\n    ref2 = this.range;\n    for (k = 0, len2 = ref2.length; k < len2; k++) {\n      y = ref2[k];\n      max_cost = Math.max.apply(0, (function() {\n        var l, len3, ref3, results;\n        ref3 = this.range;\n        results = [];\n        for (l = 0, len3 = ref3.length; l < len3; l++) {\n          x = ref3[l];\n          results.push(this.cost_matrix[x][y]);\n        }\n        return results;\n      }).call(this));\n      ref3 = this.range;\n      for (l = 0, len3 = ref3.length; l < len3; l++) {\n        x = ref3[l];\n        this.cost_matrix[x][y] -= max_cost;\n      }\n      this.y_label[y] = 0;\n    }\n  };\n\n  Hungarian.prototype.find_greedy_solution = function() {\n    var i, len, ref, results, x, y;\n    ref = this.range;\n    results = [];\n    for (i = 0, len = ref.length; i < len; i++) {\n      x = ref[i];\n      results.push((function() {\n        var j, len1, ref1, results1;\n        ref1 = this.range;\n        results1 = [];\n        for (j = 0, len1 = ref1.length; j < len1; j++) {\n          y = ref1[j];\n          if (this.x_match[x] === -1 && this.y_match[y] === -1 && (this.cost(x, y)) === 0) {\n            this.match(x, y);\n            results1.push(this.matched += 1);\n          } else {\n            results1.push(void 0);\n          }\n        }\n        return results1;\n      }).call(this));\n    }\n    return results;\n  };\n\n  Hungarian.prototype.cost = function(x, y) {\n    return this.cost_matrix[x][y] - this.x_label[x] - this.y_label[y];\n  };\n\n  Hungarian.prototype.match = function(x, y) {\n    this.x_match[x] = y;\n    return this.y_match[y] = x;\n  };\n\n  Hungarian.prototype.augment = function() {\n    var cur_x, cur_y, delta, delta_x, delta_y, i, j, len, len1, new_slack, next_y, ref, ref1, ref2, root, slack, slack_x, x, x_in_tree, y, y_parent;\n    x_in_tree = (function() {\n      var i, len, ref, results;\n      ref = this.range;\n      results = [];\n      for (i = 0, len = ref.length; i < len; i++) {\n        x = ref[i];\n        results.push(false);\n      }\n      return results;\n    }).call(this);\n    y_parent = (function() {\n      var i, len, ref, results;\n      ref = this.range;\n      results = [];\n      for (i = 0, len = ref.length; i < len; i++) {\n        y = ref[i];\n        results.push(-1);\n      }\n      return results;\n    }).call(this);\n    ref = this.find_root_and_slacks(), root = ref[0], slack = ref[1], slack_x = ref[2];\n    x_in_tree[root] = true;\n    while (true) {\n      delta = Infinity;\n      ref1 = this.range;\n      for (i = 0, len = ref1.length; i < len; i++) {\n        y = ref1[i];\n        if (y_parent[y] < 0 && slack[y] < delta) {\n          delta = slack[y];\n          delta_x = slack_x[y];\n          delta_y = y;\n        }\n      }\n      this.update_labels(delta, x_in_tree, y_parent, slack);\n      y_parent[delta_y] = delta_x;\n      if (this.y_match[delta_y] < 0) {\n        cur_y = delta_y;\n        while (cur_y >= 0) {\n          cur_x = y_parent[cur_y];\n          next_y = this.x_match[cur_x];\n          this.match(cur_x, cur_y);\n          cur_y = next_y;\n        }\n        this.matched += 1;\n        return;\n      }\n      x = this.y_match[delta_y];\n      x_in_tree[x] = true;\n      ref2 = this.range;\n      for (j = 0, len1 = ref2.length; j < len1; j++) {\n        y = ref2[j];\n        if (y_parent[y] < 0) {\n          new_slack = -(this.cost(x, y));\n          if (slack[y] > new_slack) {\n            slack[y] = new_slack;\n            slack_x[y] = x;\n          }\n        }\n      }\n    }\n  };\n\n  Hungarian.prototype.find_root_and_slacks = function() {\n    var i, len, ref, x, y;\n    ref = this.range;\n    for (i = 0, len = ref.length; i < len; i++) {\n      x = ref[i];\n      if (this.x_match[x] < 0) {\n        return [\n          x, (function() {\n            var j, len1, ref1, results;\n            ref1 = this.range;\n            results = [];\n            for (j = 0, len1 = ref1.length; j < len1; j++) {\n              y = ref1[j];\n              results.push(-(this.cost(x, y)));\n            }\n            return results;\n          }).call(this), (function() {\n            var j, len1, ref1, results;\n            ref1 = this.range;\n            results = [];\n            for (j = 0, len1 = ref1.length; j < len1; j++) {\n              y = ref1[j];\n              results.push(x);\n            }\n            return results;\n          }).call(this)\n        ];\n      }\n    }\n  };\n\n  Hungarian.prototype.update_labels = function(delta, x_in_tree, y_parent, slack) {\n    var i, j, len, len1, ref, ref1, results, x, y;\n    ref = this.range;\n    for (i = 0, len = ref.length; i < len; i++) {\n      x = ref[i];\n      if (x_in_tree[x]) {\n        this.x_label[x] -= delta;\n      }\n    }\n    ref1 = this.range;\n    results = [];\n    for (j = 0, len1 = ref1.length; j < len1; j++) {\n      y = ref1[j];\n      if (y_parent[y] < 0) {\n        results.push(slack[y] -= delta);\n      } else {\n        results.push(this.y_label[y] += delta);\n      }\n    }\n    return results;\n  };\n\n  Hungarian.prototype.get_final_score = function(original_matrix) {\n    var x;\n    return Util.sum((function() {\n      var i, len, ref, results;\n      ref = this.range;\n      results = [];\n      for (i = 0, len = ref.length; i < len; i++) {\n        x = ref[i];\n        results.push(original_matrix[x][this.x_match[x]]);\n      }\n      return results;\n    }).call(this));\n  };\n\n  return Hungarian;\n\n})();\n\nexport {Hungarian};\n"]},"sourceType":"module","externalDependencies":{},"hash":"c1968e7b07732fae20381d40775b48c3c414c371"}
